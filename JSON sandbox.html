<!DOCTYPE html>
<html>
<head>
	<link href="https://fonts.googleapis.com/css?family=Faster+One" rel="stylesheet"> 
    <link rel="stylesheet" href="styleJSON.css">
	<title>JSON Sandbox</title>
	
	<script type="text/javascript">
		var responseJson;
		var superHeroes2={
			  "squadName": "Super hero squad",
			  "homeTown": "Metro City",
			  "formed": 2016,
			  "secretBase": "Super tower",
			  "active": true,
			  "members": [
			    {
			      "name": "Molecule Man",
			      "age": 29,
			      "secretIdentity": "Dan Jukes",
			      "powers": [
			        "Radiation resistance",
			        "Turning tiny",
			        "Radiation blast"
			      ]
			    },
			    {
			      "name": "Madame Uppercut",
			      "age": 39,
			      "secretIdentity": "Jane Wilson",
			      "powers": [
			        "Million tonne punch",
			        "Damage resistance",
			        "Superhuman reflexes"
			      ]
			    },
			    {
			      "name": "Eternal Flame",
			      "age": 1000000,
			      "secretIdentity": "Unknown",
			      "powers": [
			        "Immortality",
			        "Heat Immunity",
			        "Inferno",
			        "Teleportation",
			        "Interdimensional travel"
			      ]
			    }
			  ]
		}
		function getJsonHeroes(url=''){
			//var requestURL = 'https://mdn.github.io/learning-area/javascript/oojs/json/superheroes.json';
			var request = new XMLHttpRequest();
			//request.open('GET', requestURL);
			request.open('GET', url);
			request.responseType = 'json';
			request.send();
			request.onload = function() {
			  var superHeroes = request.response;
			  populateHeader(superHeroes);
			  showHeroes(superHeroes);
			}
		}
		function getJson(url='',viaCors=true){
			
			if(viaCors){
				// cors sirve como proxy externo
				//http://cors.io/?u=http://content.warframe.com/dynamic/worldState.php
				url="http://cors.io/?u="+url;
			}
			var request = new XMLHttpRequest();
			request.open('GET', url);
			request.responseType = 'json';
			request.send();
			request.onload = function() {
			  var dataJson = request.response;
			  //alert(dataJson['USD']['transferencia']);
			  console.log(request.response);
			  responseJson=request.response;
			  return request.response;
			}
		}

		function populateHeader(jsonObj) {
		  var myH1 = document.createElement('h1');
		  myH1.textContent = jsonObj['squadName'];
		  header.appendChild(myH1);

		  var myPara = document.createElement('p');
		  myPara.textContent = 'Hometown: ' + jsonObj['homeTown'] + ' // Formed: ' + jsonObj['formed'];
		  header.appendChild(myPara);
		}

		function showHeroes(jsonObj) {
		  var heroes = jsonObj['members'];
		      
		  for (var i = 0; i < heroes.length; i++) {
		    var myArticle = document.createElement('article');
		    var myH2 = document.createElement('h2');
		    var myPara1 = document.createElement('p');
		    var myPara2 = document.createElement('p');
		    var myPara3 = document.createElement('p');
		    var myList = document.createElement('ul');

		    myH2.textContent = heroes[i].name;
		    myPara1.textContent = 'Secret identity: ' + heroes[i].secretIdentity;
		    myPara2.textContent = 'Age: ' + heroes[i].age;
		    myPara3.textContent = 'Superpowers:';
		        
		    var superPowers = heroes[i].powers;
		    for (var j = 0; j < superPowers.length; j++) {
		      var listItem = document.createElement('li');
		      listItem.textContent = superPowers[j];
		      myList.appendChild(listItem);
		    }

		    myArticle.appendChild(myH2);
		    myArticle.appendChild(myPara1);
		    myArticle.appendChild(myPara2);
		    myArticle.appendChild(myPara3);
		    myArticle.appendChild(myList);

		    section.appendChild(myArticle);
		  }
		}

		function getWFWorldstate(proxy=false){
			var dataJson=getJson("http://content.warframe.com/dynamic/worldState.php",proxy);
		}
		function getWFstatus(proxy=false){
			var dataJson=getJson("https://ws.warframestat.us/pc",proxy);
		}
		function getEstadoDolar(proxy=false){
			var dataJson=getJson("https://s3.amazonaws.com/dolartoday/data.json",proxy);
			alert(dataJson['USD']['transferencia']);
		}
	</script>
</head>
<body>
	<h1>Json TEST</h1>
	<a href="https://developer.mozilla.org/es/docs/Learn/JavaScript/Objects/JSON">Ir al tutorial</a>
	<div class="tips">
		<ul>
			<li><a href="https://docs.google.com/document/d/1121cjBNN4BeZdMBGil6Qbuqse-sWpEXPpitQH5fb_Fo/edit#">API WF MARKET</a></li>
			<li><a href="http://content.warframe.com/dynamic/worldState.php">WF WorldState</a></li>
			<li><a href="https://ws.warframestat.us/pc">Otro test para WF</a>
			<li><a href="https://s3.amazonaws.com/dolartoday/data.json">Estado dolar</li>
			<li><a href="http://jsonviewer.stack.hu/">Para ver mejor los JSON</a></li>
		</ul>
	</div>
	<hr>

	  <header>

      </header>

      <section>

      </section>

    <script>
	    // https://www.w3schools.com/jsref/met_document_queryselector.asp
	    var header = document.querySelector('header');
	    var section = document.querySelector('section');    
    </script>

</body>
</html>